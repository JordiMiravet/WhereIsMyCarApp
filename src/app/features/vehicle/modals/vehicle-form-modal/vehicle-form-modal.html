<div 
    class="modal" 
    role="dialog"
    aria-modal="true" 
    aria-labelledby="modal-title"
    (click)="onCancel()"
>
    <form 
        [formGroup]="form" 
        (keydown.enter)="$event.preventDefault(); onSubmit()" 
        class="modal__form"
        (click)="$event.stopPropagation()"
    >
        
        <fieldset class="modal__fieldset">
                
            <legend id="modal-title" class="modal__legend">
                <i class="pi pi-car" aria-hidden="true"></i>
                {{ mode() === 'create' ? 'Create Vehicle' : 'Edit Vehicle' }}
            </legend>

            <div class="modal__form-section">
                <label for="createVehicleName" class="modal__label">Name *</label>
                <input 
                    type="text" 
                    id="createVehicleName" 
                    formControlName="name" 
                    class="modal__input" 
                    placeholder="Vehicle Name"
                    [ngClass]="{'modal__input--error': form.controls['name'].invalid && form.controls['name'].touched}"
                    [attr.aria-invalid]="form.controls['name'].invalid && form.controls['name'].touched"
                    aria-describedby="createVehicleName-error"
                />
                
                <p 
                    id="createVehicleName-error" 
                    class="modal__error-text" 
                    role="alert"
                    [hidden]="form.controls['name'].valid || !form.controls['name'].touched"
                >
                    <i class="pi pi-exclamation-circle" aria-hidden="true"></i>
                    {{ getFieldError('name') }}
                </p>
            </div>

            <div class="modal__form-section">
                <label for="createVehicleModel" class="modal__label">Model *</label>
                <input 
                    type="text" 
                    id="createVehicleModel" 
                    formControlName="model" 
                    class="modal__input"
                    placeholder="Vehicle Model"
                    [ngClass]="{'modal__input--error': form.controls['model'].invalid && form.controls['model'].touched}"
                    [attr.aria-invalid]="form.controls['model'].invalid && form.controls['model'].touched"
                    aria-describedby="createVehicleModel-error"
                />
                
                <p 
                    id="createVehicleModel-error" 
                    class="modal__error-text" 
                    role="alert"
                    [hidden]="form.controls['model'].valid || !form.controls['model'].touched"
                >
                    <i class="pi pi-exclamation-circle" aria-hidden="true"></i>
                    {{ getFieldError('model') }}
                </p>
            </div>

            <div class="modal__form-section">
                <label for="createVehiclePlate" class="modal__label">Plate *</label>
                <input 
                    type="text" 
                    id="createVehiclePlate" 
                    formControlName="plate" 
                    class="modal__input" 
                    placeholder="Vehicle Plate"
                    [ngClass]="{'modal__input--error': form.controls['plate'].invalid && form.controls['plate'].touched}"
                    [attr.aria-invalid]="form.controls['plate'].invalid && form.controls['plate'].touched"
                    aria-describedby="createVehiclePlate-error"
                />
                
                <p 
                    id="createVehiclePlate-error" 
                    class="modal__error-text" 
                    role="alert"
                    [hidden]="form.controls['plate'].valid || !form.controls['plate'].touched"
                >
                    <i class="pi pi-exclamation-circle" aria-hidden="true"></i>
                    {{ getFieldError('plate') }}
                </p>
            </div>

        </fieldset>

        <div class="modal__actions">
            <button 
                type="button" 
                class="modal__button modal__button--save" 
                (click)="onSubmit()" 
                [disabled]="form.invalid"
                [attr.aria-disabled]="form.invalid"
            >
                <i class="pi pi-save" aria-hidden="true"></i>
                {{ mode() === 'create' ? 'Create' : 'Update' }}
            </button>
            
            <button type="button" class="modal__button modal__button--cancel" (click)="onCancel()">
                Cancel
            </button>
        </div>

        <p class="modal__note">
            <i class="pi pi-exclamation-circle" aria-hidden="true"></i>
            Fields marked with * are required
        </p>
    </form>

</div>
